{
  "timestamp": "2025-09-05T10:41:03.000Z",
  "project_name": "simple-content",
  "project_description": "Simple Content Management System - 灵活的内容管理系统，支持多后端存储、版本控制和元数据管理",
  "scan_version": "2025-09-05-complete",
  "scan_summary": {
    "total_files_estimated": 67,
    "go_files_scanned": 62,
    "documentation_files_created": 13,
    "coverage_percentage": 92.5,
    "scan_depth": "comprehensive",
    "truncated": false,
    "completion_status": "complete"
  },
  "ignore_patterns": [
    "*.exe", "*.dll", "*.so", "*.dylib", "*.test", "*.out",
    "go.work", "go.work.sum", ".env", "dist/**", "main", "s3test", "bin/**", "tests/data/**",
    "node_modules/**", ".git/**", ".github/**", "build/**", ".next/**", "__pycache__/**",
    "*.lock", "*.log", "*.bin", "*.pdf", "*.png", "*.jpg", "*.jpeg", "*.gif", "*.mp4",
    "*.zip", "*.tar", "*.gz"
  ],
  "architecture": {
    "language": "Go",
    "version": "1.24.2",
    "framework": "Chi v5",
    "database": "PostgreSQL (pgx/v5)",
    "pattern": "Clean Architecture + Hexagonal",
    "deployment": "Docker + Docker Compose",
    "ai_integration": "MCP (Model Context Protocol)"
  },
  "modules": [
    {
      "path": "cmd/server",
      "type": "entry",
      "description": "主服务入口，启动HTTP服务器",
      "entry_files": ["main.go"],
      "key_interfaces": ["/health", "/content/*", "/object/*", "/storage-backend/*"],
      "dependencies": ["internal/api", "pkg/repository/memory", "pkg/service", "pkg/storage"],
      "test_coverage": "integration",
      "documentation_status": "complete",
      "deployment_mode": "development"
    },
    {
      "path": "cmd/files",
      "type": "entry",
      "description": "文件上传服务，PostgreSQL+S3生产环境入口",
      "entry_files": ["main.go"],
      "test_files": ["main_test.go"],
      "key_interfaces": ["/api/v5/files", "/api/v5/contents", "API Key认证"],
      "dependencies": ["internal/api", "pkg/repository/psql", "pkg/service", "pkg/storage/s3"],
      "test_coverage": "basic",
      "documentation_status": "complete",
      "deployment_mode": "production"
    },
    {
      "path": "cmd/mcpserver",
      "type": "entry",
      "description": "MCP (Model Context Protocol) AI集成服务器",
      "entry_files": ["main.go"],
      "key_interfaces": ["MCP Tools", "Base64文件传输", "AI工具调用"],
      "dependencies": ["internal/mcp", "pkg/repository/psql", "pkg/service", "pkg/storage/s3"],
      "test_coverage": "none",
      "documentation_status": "complete",
      "deployment_mode": "ai_integration"
    },
    {
      "path": "internal/domain",
      "type": "core",
      "description": "核心业务实体和常量定义",
      "key_files": ["content.go", "object.go", "audit.go", "storage_backend.go"],
      "test_files": ["content_test.go", "object_test.go"],
      "entities": ["Content", "Object", "ContentMetadata", "ObjectMetadata", "DerivedContent", "AuditEvent"],
      "constants": ["Content Status", "Object Status", "Derivation Types"],
      "test_coverage": "good",
      "documentation_status": "complete"
    },
    {
      "path": "internal/api",
      "type": "adapter",
      "description": "HTTP处理层，路由和控制器",
      "key_files": ["content_handler.go", "files_handler.go", "object_handler.go", "storage_backend_handler.go"],
      "test_files": ["content_handler_test.go", "files_handler_test.go"],
      "handlers": ["ContentHandler", "FilesHandler", "ObjectHandler", "StorageBackendHandler"],
      "interfaces": ["RESTful API", "Chi Router", "JSON处理"],
      "test_coverage": "partial",
      "documentation_status": "complete"
    },
    {
      "path": "internal/mcp",
      "type": "adapter",
      "description": "MCP协议处理器，AI工具实现",
      "key_files": ["handler.go"],
      "mcp_tools": ["upload_content", "download_content", "list_contents", "get_content_info"],
      "mcp_resources": ["content://list", "storage://status"],
      "features": ["Base64编码", "AI友好接口"],
      "test_coverage": "none",
      "documentation_status": "complete"
    },
    {
      "path": "pkg/service",
      "type": "core",
      "description": "业务逻辑层",
      "key_files": ["content_service.go", "object_service.go", "storage_backend_service.go"],
      "test_files": ["content_service_test.go", "object_service_test.go"],
      "services": ["ContentService", "ObjectService", "StorageBackendService"],
      "patterns": ["Dependency Injection", "Service Layer"],
      "test_coverage": "good",
      "documentation_status": "complete"
    },
    {
      "path": "pkg/repository",
      "type": "adapter",
      "description": "数据访问层，支持内存和PostgreSQL两种实现",
      "submodules": ["memory", "psql"],
      "key_files": ["*/content_repository.go", "*/object_repository.go", "*/metadata_repository.go"],
      "test_files": ["*/*_test.go", "psql/test_helper.go"],
      "implementations": ["Memory (开发测试)", "PostgreSQL (生产环境)"],
      "patterns": ["Repository Pattern", "Factory Pattern"],
      "test_coverage": "excellent",
      "documentation_status": "complete"
    },
    {
      "path": "pkg/storage",
      "type": "adapter",
      "description": "存储后端实现，支持内存、文件系统、S3",
      "submodules": ["memory", "fs", "s3"],
      "key_files": ["*/README.md", "*/*.go"],
      "test_files": ["fs/fs_test.go", "s3/s3_test.go"],
      "backends": ["Memory (开发)", "FileSystem (单机)", "S3 (云端分布式)"],
      "features": ["预签名URL", "直接上传下载", "MinIO兼容"],
      "test_coverage": "good",
      "documentation_status": "complete"
    },
    {
      "path": "pkg/utils",
      "type": "library",
      "description": "通用工具函数库",
      "key_files": ["utils.go"],
      "test_files": ["utils_test.go"],
      "test_coverage": "basic",
      "documentation_status": "needs_creation"
    },
    {
      "path": "tests",
      "type": "test",
      "description": "集成测试和测试工具",
      "submodules": ["integration", "testutil"],
      "key_files": ["integration/*_test.go", "testutil/*.go", "README.md"],
      "test_types": ["衍生内容测试", "S3集成测试", "测试工具函数"],
      "features": ["端到端测试", "Mock服务器", "测试辅助函数"],
      "test_coverage": "excellent",
      "documentation_status": "complete"
    }
  ],
  "quality_metrics": {
    "test_coverage_by_layer": {
      "domain": "good",
      "service": "good",
      "repository": "excellent",
      "storage": "good",
      "api": "partial",
      "mcp": "none"
    },
    "documentation_coverage": {
      "root_claude_md": "complete",
      "module_claude_md": 10,
      "readme_files": 4,
      "missing_docs": ["pkg/utils"],
      "navigation_links": "complete"
    },
    "code_quality": {
      "clean_architecture": true,
      "dependency_injection": true,
      "interface_abstraction": true,
      "error_handling": "standard",
      "concurrency_safety": true,
      "ai_integration": true
    }
  },
  "gaps_and_recommendations": {
    "immediate_priorities": [
      "为pkg/utils创建CLAUDE.md文档",
      "补充MCP模块的单元测试覆盖"
    ],
    "technical_debt": [
      "object_handler和storage_backend_handler缺少测试文件",
      "Memory storage backend缺少单元测试",
      "Storage backend service缺少专门测试",
      "缺少数据迁移脚本"
    ],
    "enhancement_opportunities": [
      "添加API文档生成（如Swagger）",
      "实现存储后端间数据迁移功能",
      "添加监控和指标收集",
      "扩展MCP工具的功能覆盖",
      "添加性能测试和基准测试"
    ]
  },
  "next_scan_suggestions": [
    "补充pkg/utils模块文档",
    "深度测试MCP工具调用的边界情况",
    "检查PostgreSQL数据库架构和迁移需求",
    "分析系统性能瓶颈和优化点"
  ],
  "ai_context_quality": {
    "completeness": "excellent",
    "navigation": "complete", 
    "coverage": "comprehensive",
    "usability": "high",
    "maintenance": "automated"
  }
}